<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>index15</title>
  </head>
  <body>
    <script type="text/javascript">
      var observer = {
        addSubscriber: function(callback) {
          if(typeof callback === 'function') {
            this.addSubscribers[this.subscribers.length] = callback
          }
        },
        removeSubscriber: function(callback) {
          for(var i = 0; i < this.subscribers.length; i++) {
            if(this.subscribers[i] === callback) {
              delete this.subscribers[i]
            }
          }
        },
        publish: function(what) {
          for(var i = 0; i < this.subscribers.length; i++) {
            if(typeof this.subscribers[i] === 'function') {
              this.subscribers[i](waht)
            }
          }
        },
        make: function(o) {
          for(var i in this) {
            if(this.hasOwnProperty(i)) {
              o[i] = this[i]
              o.subscribers = []
            }
          }
        }
      }

      var blogger = {
        writeBlogPost: function() {
          var content = 'Today is ' + new Date()
          this.publish(content)
        }
      }

      var la_times = {
        newIssue: function() {
          var paper = 'Martians have landed on Earth!'
          this.publish(paper)
        }
      }
    console.log(observer.make(blogger))
    console.log(observer.make(la_times))

    var jack = {
      read: function(what) {
        console.log('I just read that ' + what)
      }
    }

    var jill = {
      gossip: function(what) {
        console.log("You didn't hear it from me, but" + what)
      }
    }

    console.log(blogger.addSubscriber(jack.read))
    console.log(blogger.addSubscriber(jill.gossip))
    </script>
  </body>
</html>
